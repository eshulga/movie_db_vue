webpackJsonp([1],{"/M9U":function(t,e){},"4+hh":function(t,e){},"4VoJ":function(t,e){},DxlN:function(t,e){},EIju:function(t,e){},H9eQ:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("ob/p"),i("j1ja");var s=i("7+uW"),r=i("Lgyv"),a=i.n(r),n=(i("4+hh"),i("nqYh")),o={name:"app-header",data:function(){return{toggleActive:!1,search:"",small:"",scroll:""}},watch:{search:function(){this.searchMovie()}},methods:{handleScroll:function(t){this.small=window.scrollY>this.scroll,this.scroll=window.scrollY},toggleSidebar:function(){this.toggleActive=!this.toggleActive,this.$eventBus.$emit("toggleSidebar")},searchMovie:function(){this.search.length>2&&this.$router.push({path:"/",query:{search:this.search}})}},created:function(){window.addEventListener("scroll",this.handleScroll)},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",[s("div",{staticClass:"header-line"},[s("md-button",{staticClass:"menu-button md-icon-button md-primary",on:{click:function(e){t.toggleSidebar()}}},[s("md-icon",[t._v("menu")])],1),t._v(" "),s("img",{attrs:{src:i("dLd/"),alt:"Logo"}})],1),t._v(" "),s("div",{staticClass:"header-bootom-line search",class:{hide:t.small}},[s("div",{staticClass:"search-wrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"search__input",attrs:{type:"text",placeholder:"Поиск...",debounce:""},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}})])])])},staticRenderFns:[]};var l={name:"sidebar",data:function(){return{active:!1,items:[{title:"Главная",route:"home"},{title:"Избранное",route:"favorites"}]}},methods:{toggleSidebar:function(){var t=this;setTimeout(function(){t.active=!t.active},500)}},mounted:function(){var t=this;this.$eventBus.$on("toggleSidebar",function(){t.active=!t.active})}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("md-drawer",{attrs:{"md-active":t.active},on:{"update:mdActive":function(e){t.active=e}}},[s("md-toolbar",{staticClass:"md-transparent",attrs:{"md-elevation":"0"}},[s("img",{attrs:{src:i("qvJq"),alt:"logo"}})]),t._v(" "),s("nav",[s("ul",t._l(t.items,function(e,i){return s("li",{key:i,on:{click:function(e){t.toggleSidebar()}}},[s("router-link",{staticClass:"sidebar__link",attrs:{to:{name:e.route}}},[t._v(t._s(e.title))])],1)}))])],1)},staticRenderFns:[]};var u={name:"App",components:{AppHeader:i("VU/8")(o,c,!1,function(t){i("d58B")},null,null).exports,AppSidebar:i("VU/8")(l,h,!1,function(t){i("H9eQ")},null,null).exports}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("app-header"),this._v(" "),e("app-sidebar"),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var v=i("VU/8")(u,d,!1,function(t){i("DxlN")},null,null).exports,f=i("/ocq"),m={API_KEY:"b4a2ddcffbf736c3e738a03f5fcc609c",getItems:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return fetch("https://api.themoviedb.org/3/movie/top_rated?api_key="+this.API_KEY+"&language=ru-RU&page="+(t||1)).then(function(t){return t.json()})},getMovieInfo:function(t){return fetch("https://api.themoviedb.org/3/movie/"+t+"?api_key="+this.API_KEY+"&language=ru-RU").then(function(t){return t.json()})},getMovieCredits:function(t){return fetch("https://api.themoviedb.org/3/movie/"+t+"/credits?api_key="+this.API_KEY+"&language=ru-RU").then(function(t){return t.json()})},getMovieTrailers:function(t){return fetch("https://api.themoviedb.org/3/movie/"+t+"/videos?api_key="+this.API_KEY+"&language=ru-RU").then(function(t){return t.json()})},searchMoviesOnQuery:function(t){return fetch("https://api.themoviedb.org/3/search/movie?query="+t+"&api_key="+this.API_KEY+"&language=ru-RU&page=1&include_adult=false").then(function(t){return t.json()})}},p={name:"movie",data:function(){return{id:parseInt(this.$route.params.id),isFavorite:this.checkFavorites(),key:this.$root.config.apiKey,movie:{},poster:"",title:"",overview:"",trailers:[],genres:[],cast:[],crew:[]}},created:function(){this.getDetails(),this.getTrailers(),this.getCredits()},watch:{isFavorite:function(t,e){var i=localStorage.getItem("favorites");i=null===i?[]:JSON.parse(i),t?i.push(this.id):i.includes(this.id)&&i.splice(i.indexOf(this.id),1),i=JSON.stringify(i),localStorage.setItem("favorites",i)}},methods:{clickFavorites:function(){this.isFavorite=!this.isFavorite},checkFavorites:function(){var t=localStorage.getItem("favorites");return null!==t&&!!(t=JSON.parse(t)).includes(parseInt(this.$route.params.id))},getDetails:function(){var t=this;m.getMovieInfo(this.id).then(function(e){return t.saveDetails(e)})},getCredits:function(){var t=this;m.getMovieCredits(this.id).then(function(e){for(var i=0;i<10;i++)t.crew.push(e.crew[i]),t.cast.push(e.cast[i])})},getTrailers:function(){var t=this;m.getMovieTrailers(this.id).then(function(e){e.results.forEach(function(e){"Trailer"===e.type&&t.trailers.push(e)})})},saveDetails:function(t){this.movie=t,this.poster=t.poster_path,this.title=t.title,this.overview=t.overview,this.genres=t.genres}}},g={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper"},[i("div",{staticClass:"movie-top"},[i("div",{staticClass:"row"},[i("div",{staticClass:"movie-poster"},[i("img",{attrs:{src:"https://image.tmdb.org/t/p/w300/"+this.poster,alt:""}})]),t._v(" "),i("div",{staticClass:"movie-description"},[i("h1",[t._v(t._s(this.title))]),t._v(" "),i("div",{staticClass:"controls"},[i("button",{staticClass:"favorits-button",class:{in_favorite:t.isFavorite},on:{click:function(e){t.clickFavorites()}}})]),t._v(" "),this.overview?i("div",{staticClass:"movie-overview"},[i("h2",[t._v("Описание")]),t._v(" "),i("p",[t._v(t._s(this.overview))])]):t._e(),t._v(" "),this.genres?i("div",{staticClass:"movie-genres"},[i("h2",[t._v("Жанры")]),t._v(" "),i("ul",t._l(t.genres,function(e){return i("li",{key:e.id},[t._v(t._s(e.name))])}))]):t._e()])]),t._v(" "),i("div",{staticClass:"row"},[this.cast?i("div",{staticClass:"movie-actors"},[i("h2",[t._v("Актеры")]),t._v(" "),i("ul",{staticClass:"cast-list"},t._l(t.cast,function(e){return i("li",{key:e.id},[i("img",{attrs:{src:"https://image.tmdb.org/t/p/w138_and_h175_face/"+e.profile_path,alt:e.name}}),t._v(" "),i("span",{staticClass:"cast__name"},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"cast__character"},[t._v(t._s(e.character))])])}))]):t._e()]),t._v(" "),i("div",{staticClass:"row"},[this.trailers.length>0?i("div",{staticClass:"trailer-wrapper"},[i("h2",[t._v("Трейлеры")]),t._v(" "),t._l(this.trailers,function(t){return i("div",{key:t.id,staticClass:"trailer-item"},[i("iframe",{staticClass:"trailer-video",attrs:{width:"100%",src:"https://www.youtube.com/embed/"+t.key,allowfullscreen:""}})])})],2):t._e()])])])},staticRenderFns:[]};var _={path:"/movie/:id",name:"movie",component:i("VU/8")(p,g,!1,function(t){i("QqjP")},"data-v-1a8c4593",null).exports},w={name:"shortCard",props:["id","title","overview","poster"]},C={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"short-card-wrapper"},[i("div",{staticClass:"short-card__img"},[i("picture",[i("source",{attrs:{srcset:"https://image.tmdb.org/t/p/w700_and_h392_bestv2/"+t.poster,media:"(max-width: 480px)"}}),t._v(" "),i("img",{attrs:{src:"https://image.tmdb.org/t/p/w185/"+t.poster}})])]),t._v(" "),i("div",{staticClass:"short-card__info"},[i("h2",{staticClass:"short-card__title"},[t._v(t._s(t.title))]),t._v(" "),i("p",{staticClass:"short-card__description"},[t._v(t._s(t.overview))]),t._v(" "),i("div",{staticClass:"short-card__controls"},[i("router-link",{staticClass:"short-card__link",attrs:{to:{name:"movie",params:{id:t.id}}}},[t._v("Подробнее")])],1)])])},staticRenderFns:[]};var b=i("VU/8")(w,C,!1,function(t){i("EIju")},"data-v-72e5a772",null).exports,I={name:"Home",components:{ShortCard:b},props:["initSearch"],data:function(){return{key:this.$root.config.apiKey,itemsColection:[],search:this.initSearch,curentPage:1}},created:function(){window.addEventListener("scroll",this.handleScroll)},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)},mounted:function(){this.search&&""!==this.search?this.searchItems():(this.itemsColection=[],this.getItems())},watch:{"$route.query.search":function(){this.search=this.initSearch,this.search&&""!==this.search?this.searchItems():(this.itemsColection=[],this.getItems())}},methods:{handleScroll:function(t){this.search||this.infiniteLoadHome()},infiniteLoadHome:function(){this.$el.scrollHeight+this.$el.offsetTop===window.scrollY+window.innerHeight&&this.getItems()},searchItems:function(){var t=this;this.itemsColection=[],m.searchMoviesOnQuery(this.search).then(function(e){t.addItemsToCollection(e)})},addItemsToCollection:function(t){var e=this;console.log(t),t.results.forEach(function(t){e.itemsColection.push(t)}),this.curentPage=t.page+1},getItems:function(){var t=this;m.getItems(this.curentPage).then(function(e){t.addItemsToCollection(e)})}}},y={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"main"},[e("div",{staticClass:"movies-wrapper"},this._l(this.itemsColection,function(t){return e("short-card",{key:t.id,attrs:{id:t.id,title:t.title,overview:t.overview,poster:t.poster_path}})})),this._v(" "),e("div",{staticClass:"page-loader"},[e("md-progress-bar",{attrs:{"md-mode":"indeterminate"}})],1)])},staticRenderFns:[]};var S={path:"/",name:"home",component:i("VU/8")(I,y,!1,function(t){i("4VoJ")},null,null).exports,props:function(t){return{initSearch:t.query.search}}},k={name:"Favorites",components:{ShortCard:b},data:function(){return{key:this.$root.config.apiKey,itemsColection:[],storedIds:[]}},created:function(){this.getMoviesIdFromStorage(),console.log("mounted",this)},watch:{storedIds:function(){var t=this;this.storedIds.forEach(function(e){m.getMovieInfo(e).then(function(e){return t.saveItems(e)})})}},methods:{saveItems:function(t){this.itemsColection.push(t)},getMoviesIdFromStorage:function(){var t=localStorage.getItem("favorites");t&&(t=JSON.parse(t)),null!==t&&t.length>0&&(this.storedIds=t)}}},E={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"main"},[e("div",{staticClass:"movies-wrapper"},this._l(this.itemsColection,function(t){return e("short-card",{key:t.id,attrs:{id:t.id,title:t.title,overview:t.overview,poster:t.poster_path}})}))])},staticRenderFns:[]};var $={path:"/favorites",name:"favorites",component:i("VU/8")(k,E,!1,function(t){i("/M9U")},null,null).exports};s.default.use(f.a);var F=new f.a({routes:[S,_,$]});s.default.config.productionTip=!1,s.default.use(a.a),s.default.use(n.a),s.default.prototype.$eventBus=new s.default,new s.default({el:"#app",router:F,render:function(t){return t(v)},data:{config:{apiKey:"b4a2ddcffbf736c3e738a03f5fcc609c"}}})},QqjP:function(t,e){},d58B:function(t,e){},"dLd/":function(t,e,i){t.exports=i.p+"static/img/logo.226be7e.png"},qvJq:function(t,e,i){t.exports=i.p+"static/img/logo2.dca8209.png"}},["NHnr"]);
//# sourceMappingURL=app.d5f40b49d11ec03409ce.js.map